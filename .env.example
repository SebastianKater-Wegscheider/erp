# --- Postgres ---
POSTGRES_USER=erp
POSTGRES_PASSWORD=erp
POSTGRES_DB=erp

# Used by the FastAPI backend (async SQLAlchemy URL)
DATABASE_URL=postgresql+asyncpg://erp:erp@db:5432/erp
# Published backend port on the host (docker compose maps BACKEND_PORT -> container 8000)
BACKEND_PORT=18000
# Optional: frontend API base (used by docker compose frontend service)
# VITE_API_BASE_URL=http://localhost:18000/api/v1

# --- App storage ---
# Mounted into the backend container via docker-compose.
APP_STORAGE_DIR=/data

# --- Basic Auth (protects all API endpoints) ---
BASIC_AUTH_USERNAME=admin
BASIC_AUTH_PASSWORD=change-me
# Kilometergeld (Cent pro km) fuer Fahrtenbuch-Bewertung.
MILEAGE_RATE_CENTS_PER_KM=42

# For browser calls (comma-separated):
# CORS_ORIGINS=http://localhost:15173,http://localhost:5173

# --- Your business (used on PDFs) ---
COMPANY_NAME=Your Company Name
COMPANY_ADDRESS=Street 1\n1010 Wien\nAustria
COMPANY_EMAIL=you@example.com
COMPANY_VAT_ID=
# Optional logo for PDFs. Either a path relative to `backend/app/templates/` (e.g. `logo.svg`)
# or an absolute path (will be auto-prefixed with `file://`).
COMPANY_LOGO_PATH=
COMPANY_SMALL_BUSINESS_NOTICE=

# --- Backup ---
BACKUP_DIR=/backups
DATA_DIR=/data
BACKUP_INTERVAL_SECONDS=86400

# --- Amazon (ASIN) scrape metrics ---
# Internal scraper service (FastAPI) base URL.
AMAZON_SCRAPER_BASE_URL=http://192.168.178.72:4236
# Enable the daily scheduler loop inside the backend.
AMAZON_SCRAPER_ENABLED=false
# Network timeout (seconds) for one scrape request.
AMAZON_SCRAPER_TIMEOUT_SECONDS=120
# Scheduler tick interval (seconds). One due product is processed per tick.
AMAZON_SCRAPER_LOOP_TICK_SECONDS=180
# Minimum time between successful scrapes per product (seconds). 172800 = 48h.
AMAZON_SCRAPER_MIN_SUCCESS_INTERVAL_SECONDS=172800
# Max retry backoff on errors/blocks (seconds). 43200 = 12h.
AMAZON_SCRAPER_MAX_BACKOFF_SECONDS=43200
# DB lock TTL for the scheduler (seconds).
AMAZON_SCRAPER_LOCK_TTL_SECONDS=300
AMAZON_SCRAPER_BUSY_RETRY_MIN_SECONDS=90
AMAZON_SCRAPER_BUSY_RETRY_MAX_SECONDS=240
AMAZON_SCRAPER_BUSY_GLOBAL_COOLDOWN_SECONDS=45
# Retries per scrape request (includes first attempt). Lower value reduces load amplification on scraper outages.
AMAZON_SCRAPER_FETCH_MAX_ATTEMPTS=2

# --- Sourcing radar ---
# Enable sourcing scheduler + APIs.
SOURCING_ENABLED=false
# Platform-specific runtime gate.
SOURCING_KLEINANZEIGEN_ENABLED=true
# Allow converting sourcing items into purchases.
SOURCING_CONVERSION_ENABLED=false
# Internal sourcing scraper service base URL.
SOURCING_SCRAPER_BASE_URL=http://sourcing-scraper:8000
# Timeout (seconds) for scraper calls.
SOURCING_SCRAPER_TIMEOUT_SECONDS=60
# Scheduler tick interval (seconds).
SOURCING_LOOP_TICK_SECONDS=60
# DB lock TTL for scheduler coordination.
SOURCING_LOCK_TTL_SECONDS=300
# Fallback interval in seconds when DB setting is absent.
SOURCING_DEFAULT_INTERVAL_SECONDS=1800
# Backoff after blocked/error runs.
SOURCING_ERROR_BACKOFF_SECONDS=300
# Minimum fuzzy confidence score fallback.
SOURCING_MATCH_CONFIDENCE_MIN_SCORE=80

# --- Amazon fee estimates (global defaults; used for margin heuristics) ---
# Referral fee in basis points (e.g. 1500 = 15%).
AMAZON_FBA_REFERRAL_FEE_BP=1500
# Per-unit fulfillment fee estimate (EUR cents).
AMAZON_FBA_FULFILLMENT_FEE_CENTS=350
# Inbound shipping estimate per unit (EUR cents).
AMAZON_FBA_INBOUND_SHIPPING_CENTS=0

# --- Target pricing engine (recommendation tunables) ---
# Net margin floor in basis points (2000 = 20%).
# TARGET_PRICING_MARGIN_FLOOR_BP=2000
# Minimum absolute net margin floor (EUR cents). 500 = 5 EUR.
# TARGET_PRICING_MARGIN_FLOOR_MIN_CENTS=500
# BSR thresholds for rank-based price adjustment.
# TARGET_PRICING_BSR_STRONG_MAX=10000
# TARGET_PRICING_BSR_WEAK_MIN=80000
# Offers-count thresholds for competition adjustment.
# TARGET_PRICING_OFFERS_LOW_MAX=2
# TARGET_PRICING_OFFERS_HIGH_MIN=12
